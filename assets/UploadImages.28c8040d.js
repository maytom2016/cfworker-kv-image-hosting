import{d as L,l as c,m as S,u as $,p as T,J as R,r as N,o as r,q as d,a as t,t as x,e as u,b as i,K as C,B as F,T as A,w as D,L as H,n as p,f as M,v as k,D as v,y,x as O,M as q,c as P,N as G}from"./vendor.8372d75e.js";import{f as b,_ as J,c as K,d as W,e as Q,g as X,a as Y}from"./ImageBox.e0da38c1.js";const Z={class:"mx-auto max-w-6xl my-4 px-4"},ee=t("div",{class:"text-gray-800 text-lg"},"\u4E0A\u4F20\u56FE\u7247",-1),ae={class:"mb-4 text-sm text-gray-500"},se={class:"border-2 border-dashed border-slate-400 rounded-md relative"},te=["onDrop"],le={key:0,class:"absolute -z-10 left-0 top-0 w-full h-full flex items-center justify-center"},oe={class:"text-gray-500"},ne=v(" \u7C98\u8D34\u6216\u62D6\u52A8\u56FE\u7247\u81F3\u6B64\u5904 "),ue={key:0,class:"w-full mt-4 flex items-center text-sm text-gray-500"},ie={class:"w-full rounded-md shadow-sm overflow-hidden mt-4 grid grid-cols-8"},re={class:"md:col-span-1 col-span-8"},ce=v(" \u9009\u62E9\u56FE\u7247 "),de={class:"md:col-span-5 col-span-8"},me={class:"w-full h-10 bg-slate-200 leading-10 px-4 text-center md:text-left"},pe={class:"md:col-span-1 col-span-3"},ve=v(" \u6E05\u9664 "),fe={class:"md:col-span-1 col-span-5"},ge=v(" \u4E0A\u4F20 "),Fe=L({setup(_e){const s=c([]),E=S(()=>s.value.reduce((a,e)=>a+e.file.size,0)),m=c(!1),f=c(new Date(new Date().setHours(new Date().getHours()+24))),w=20*1024*1024,g=c(),n=c(!1),z=$(),U=()=>{var a;_((a=g.value)==null?void 0:a.files)},B=a=>{var e;_((e=a.dataTransfer)==null?void 0:e.files)},I=a=>{var e;_((e=a.clipboardData)==null?void 0:e.files)};T(()=>{document.onpaste=I}),R(()=>{document.onpaste=null,s.value.forEach(a=>URL.revokeObjectURL(a.tmpSrc))});const _=async a=>{if(!!a){n.value=!0;for(let e=0;e<a.length;e++){const o=a.item(e);if(!o)return;if(o.size>w){y({message:`${o.name} \u6587\u4EF6\u8FC7\u5927`,type:"error"});continue}if(!o.type.startsWith("image/")){y({message:`${o.name} \u4E0D\u662F\u56FE\u7247\u6587\u4EF6`,type:"error"});continue}s.value=[...s.value,{file:o,tmpSrc:URL.createObjectURL(o)}]}n.value=!1}},V=a=>{s.value=s.value.filter(e=>e.tmpSrc!==a),URL.revokeObjectURL(a)},j=()=>{n.value=!0;const a=new FormData;m.value&&a.append("Expiration",String(f.value.getTime()));for(let e of s.value)a.append("Images",e.file);X(a).then(()=>{y({title:"\u4E0A\u4F20\u5B8C\u6210",message:`\u5171 ${s.value.length} \u5F20\u56FE\u7247\uFF0C${b(E.value)}`,type:"success"}),s.value=[],z.push("/")}).catch(()=>{}).finally(()=>{n.value=!1})};return(a,e)=>{const o=N("font-awesome-icon");return r(),d(k,null,[t("div",Z,[ee,t("div",ae," \u6BCF\u5F20\u56FE\u7247\u5927\u5C0F\u4E0D\u8D85\u8FC7 "+x(u(b)(w)),1),t("div",se,[i(J,{loading:n.value},null,8,["loading"]),t("div",{class:"grid p-4 gap-4 grid-cols-3 min-h-[240px]",onDrop:C(B,["prevent"]),onDragover:e[0]||(e[0]=C(()=>{},["prevent"]))},[s.value.length===0?(r(),d("div",le,[t("div",oe,[i(o,{icon:u(K)},null,8,["icon"]),ne])])):F("",!0),i(A,{name:"el-fade-in-linear"},{default:D(()=>[(r(!0),d(k,null,O(s.value,l=>(r(),d("div",{class:"col-span-3 md:col-span-1",key:l.tmpSrc},[i(Y,{src:l.tmpSrc,size:l.file.size,name:l.file.name,onDelete:h=>V(l.tmpSrc),mode:"converted"},null,8,["src","size","name","onDelete"])]))),128))]),_:1})],40,te)]),i(H,{name:"el-zoom-in-top"},{default:D(()=>[s.value.length?(r(),d("div",ue,[i(u(q),{class:p(["h-6",{"area-disabled":n.value}]),modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),size:"large",label:"\u8FC7\u671F\u5220\u9664"},null,8,["class","modelValue"]),m.value?(r(),P(u(G),{key:0,disabled:n.value,modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),"popper-class":"remove-now-btn",size:"small",class:"ml-2",type:"datetime",placeholder:"\u9009\u62E9\u8FC7\u671F\u65F6\u95F4","disabled-date":l=>l<new Date},null,8,["disabled","modelValue","disabled-date"])):F("",!0)])):F("",!0)]),_:1}),t("div",ie,[t("div",re,[t("div",{class:p(["w-full h-10 bg-blue-500 cursor-pointer flex items-center justify-center text-white",{"area-disabled":n.value}]),onClick:e[3]||(e[3]=l=>{var h;return(h=g.value)==null?void 0:h.click()})},[i(o,{icon:u(W),class:"mr-2"},null,8,["icon"]),ce],2)]),t("div",de,[t("div",me," \u5DF2\u9009\u62E9 "+x(s.value.length)+" \u5F20\uFF0C\u5171 "+x(u(b)(u(E))),1)]),t("div",pe,[t("div",{class:p(["w-full bg-red-500 cursor-pointer h-10 flex items-center justify-center text-white",{"area-disabled":s.value.length===0||n.value}]),onClick:e[4]||(e[4]=l=>s.value=[])},[i(o,{icon:u(Q),class:"mr-2"},null,8,["icon"]),ve],2)]),t("div",fe,[t("div",{class:p(["w-full h-10 flex items-center justify-center text-white bg-green-500 cursor-pointer",{"area-disabled":s.value.length===0||n.value}]),onClick:j},[i(o,{icon:u(M),class:"mr-2"},null,8,["icon"]),ge],2)])])]),t("input",{ref_key:"input",ref:g,type:"file",accept:"image/*",class:"hidden",multiple:"",onChange:U},null,544)],64)}}});export{Fe as default};
